## Building pandoc from source in containers

### 1. Build GHC image

Build GHC from source using GHC from EPEL 9 as bootstrap:

```
./fetch-ghc.sh

podman build -t ghc:9.2.8-ubi9 -f Containerfile.ghc .
```

### 2. Build cabal image

Build Cabal from source using image with GHC from previous step:

```
./fetch-cabal.sh

podman build -t cabal:3.10.3.0-ubi9 -f Containerfile.cabal .
```

### 3. Fetch pandoc dependencies

Optionally, regenerate pandoc dependencies using Cabal image from previous step. This repo already contains `pandoc-deps.txt` generated by this command:

```
./generate-pandoc-deps.sh
```

Download all dependencies:

```
./fetch-pandoc.sh
```

### 4. Build pandoc image

Build pandoc from source using only pre-downloaded tarballs from previous step:

```
podman build -t pandoc:3.7.0.2-ubi9 -f Containerfile.pandoc .
```

```
...
[2/2] STEP 4/7: RUN pandoc --version
pandoc 3.7.0.2
Features: -server -lua
Scripting engine: none
User data directory: /root/.local/share/pandoc
Copyright (C) 2006-2024 John MacFarlane. Web: https://pandoc.org
This is free software; see the source for copying conditions. There is no
warranty, not even for merchantability or fitness for a particular purpose.
...
```
